<?php

Route::prefix('{{prefix}}')
    ->namespace('App\{{Prefix}}\Controllers')
    ->middleware('bindings')
    ->group(function () {
    Route::post('login', '\Cc\Labems\Controllers\BaseController@login');
    Route::get('logout', '\Cc\Labems\Controllers\BaseController@logout');

    Route::middleware('Labems.auth')
        ->group(function () {
        Route::post('changePassword', '\Cc\Labems\Controllers\BaseController@changePassword');
        Route::get('sysInfo', '\Cc\Labems\Controllers\BaseController@sysInfo');
        Route::apiResource('attachment', '\Cc\Labems\Controllers\AttachmentController')->except(['show', 'update']);

        Route::middleware('Labems.permission')
            ->group(function () {
            Route::apiResource('user', '\Cc\Labems\Controllers\UserController');
            Route::apiResource('home', HomeController::class);

        });
    });

    Route::fallback(function () {
        return err('not found');
    });
});
